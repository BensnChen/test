<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DDPåœ¨é€”åº“å­˜ç›‘æ§ç³»ç»Ÿ</title>
    
    <!-- ä½¿ç”¨æ›´ç¨³å®šçš„CDNå’Œç‰ˆæœ¬ -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/dayjs@1.11.10/dayjs.min.js"></script>
    <script src="https://unpkg.com/dayjs@1.11.10/locale/zh-cn.js"></script>
    
    <!-- ä½¿ç”¨å…¼å®¹æ€§æ›´å¥½çš„Ant Designç‰ˆæœ¬ -->
    <link rel="stylesheet" href="https://unpkg.com/antd@4.24.15/dist/antd.min.css">
    <script src="https://unpkg.com/antd@4.24.15/dist/antd.min.js"></script>
    
    <!-- Babelæœ€ååŠ è½½ -->
    <script src="https://unpkg.com/@babel/standalone@7.23.4/babel.min.js"></script>
    
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f5f5f5;
        }
        
        .app-container {
            padding: 24px;
            min-height: 100vh;
        }
        
        .page-header {
            background: white;
            padding: 24px;
            margin-bottom: 24px;
            border-radius: 8px;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.03);
        }
        
        .page-title {
            font-size: 24px;
            font-weight: 600;
            color: #262626;
            margin: 0 0 8px 0;
        }
        
        .page-description {
            color: #8c8c8c;
            margin: 0;
        }
        
        .filter-section {
            background: white;
            padding: 24px;
            margin-bottom: 24px;
            border-radius: 8px;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.03);
        }
        
        .table-section {
            background: white;
            padding: 24px;
            border-radius: 8px;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.03);
        }
        
        .table-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .toolbar-left {
            display: flex;
            gap: 8px;
        }
        
        .toolbar-right {
            display: flex;
            gap: 8px;
        }
        
        .ant-table-thead > tr > th {
            background-color: #fafafa;
            font-weight: 600;
        }
        
        .ant-table-tbody > tr:hover > td {
            background-color: #f5f5f5;
        }
    </style>
</head>
<body>
    <div id="root">
        <div style="display: flex; justify-content: center; align-items: center; height: 100vh;">
            <div style="text-align: center;">
                <div style="font-size: 24px; margin-bottom: 16px;">ğŸ”„ åŠ è½½ä¸­...</div>
                <div style="color: #666;">æ­£åœ¨åˆå§‹åŒ–DDPåœ¨é€”åº“å­˜ç›‘æ§ç³»ç»Ÿ</div>
            </div>
        </div>
    </div>

    <script type="text/babel">
        // ç­‰å¾…æ‰€æœ‰èµ„æºåŠ è½½å®Œæˆ
        window.addEventListener('load', function() {
            // æ£€æŸ¥ä¾èµ–æ˜¯å¦åŠ è½½æˆåŠŸ
            if (typeof React === 'undefined') {
                document.getElementById('root').innerHTML = '<div style="text-align: center; padding: 50px; color: red;">React åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥</div>';
                return;
            }
            
            if (typeof antd === 'undefined') {
                document.getElementById('root').innerHTML = '<div style="text-align: center; padding: 50px; color: red;">Ant Design åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥</div>';
                return;
            }

            // å¼€å§‹æ¸²æŸ“åº”ç”¨
            renderApp();
        });

        function renderApp() {
            const { useState, useMemo } = React;
            const { 
                Table, 
                Button, 
                Space, 
                Form, 
                Input, 
                Select, 
                DatePicker, 
                Tag, 
                Modal, 
                Upload, 
                message,
                Tooltip,
                Popconfirm,
                Card,
                Row,
                Col,
                Statistic,
                Typography
            } = antd;
            
            const { RangePicker } = DatePicker;
            const { Option } = Select;
            const { Dragger } = Upload;
            const { Title, Text } = Typography;

            // é…ç½®dayjs
            if (typeof dayjs !== 'undefined') {
                dayjs.locale('zh-cn');
            }

            // æ¨¡æ‹Ÿæ•°æ®
            const mockData = [
                {
                    key: '1',
                    purchaseOrderNo: 'PO202412001',
                    stockOrderNo: 'SO202412001',
                    shipQuantity: 1000,
                    destinationWarehouse: 'ç¾å›½è¥¿æµ·å²¸ä»“',
                    shipDate: '2024-12-01',
                    arrivalPortDate: '2024-12-15',
                    arrivalWarehouseDate: '2024-12-18',
                    shelfDate: '2024-12-20',
                    actualShelfQuantity: 980,
                    status: 'shelved'
                },
                {
                    key: '2',
                    purchaseOrderNo: 'PO202412002',
                    stockOrderNo: 'SO202412002',
                    shipQuantity: 1500,
                    destinationWarehouse: 'æ¬§æ´²ä¸­å¿ƒä»“',
                    shipDate: '2024-12-05',
                    arrivalPortDate: '2024-12-20',
                    arrivalWarehouseDate: null,
                    shelfDate: null,
                    actualShelfQuantity: null,
                    status: 'in-transit'
                },
                {
                    key: '3',
                    purchaseOrderNo: 'PO202412003',
                    stockOrderNo: 'SO202412003',
                    shipQuantity: 800,
                    destinationWarehouse: 'æ—¥æœ¬ä¸œäº¬ä»“',
                    shipDate: '2024-11-28',
                    arrivalPortDate: '2024-12-10',
                    arrivalWarehouseDate: '2024-12-12',
                    shelfDate: '2024-12-14',
                    actualShelfQuantity: 800,
                    status: 'shelved'
                },
                {
                    key: '4',
                    purchaseOrderNo: 'PO202412004',
                    stockOrderNo: 'SO202412004',
                    shipQuantity: 1200,
                    destinationWarehouse: 'æ¾³æ´²æ‚‰å°¼ä»“',
                    shipDate: '2024-12-08',
                    arrivalPortDate: null,
                    arrivalWarehouseDate: null,
                    shelfDate: null,
                    actualShelfQuantity: null,
                    status: 'in-transit'
                },
                {
                    key: '5',
                    purchaseOrderNo: 'PO202412005',
                    stockOrderNo: 'SO202412005',
                    shipQuantity: 600,
                    destinationWarehouse: 'åŠ æ‹¿å¤§æ¸©å“¥åä»“',
                    shipDate: '2024-11-25',
                    arrivalPortDate: '2024-12-08',
                    arrivalWarehouseDate: '2024-12-10',
                    shelfDate: null,
                    actualShelfQuantity: null,
                    status: 'cancelled'
                }
            ];

            // çŠ¶æ€é…ç½®
            const statusConfig = {
                'in-transit': { text: 'åœ¨é€”ä¸­', color: 'processing' },
                'shelved': { text: 'å·²ä¸Šæ¶', color: 'success' },
                'cancelled': { text: 'å·²å–æ¶ˆ', color: 'warning' }
            };

            // ä»“åº“é€‰é¡¹
            const warehouseOptions = [
                'ç¾å›½è¥¿æµ·å²¸ä»“',
                'ç¾å›½ä¸œæµ·å²¸ä»“',
                'æ¬§æ´²ä¸­å¿ƒä»“',
                'è‹±å›½ä¼¦æ•¦ä»“',
                'æ—¥æœ¬ä¸œäº¬ä»“',
                'æ¾³æ´²æ‚‰å°¼ä»“',
                'åŠ æ‹¿å¤§æ¸©å“¥åä»“'
            ];

            // ä¸»ç»„ä»¶
            const DDPInventoryMonitor = () => {
                const [data, setData] = useState(mockData);
                const [loading, setLoading] = useState(false);
                const [selectedRowKeys, setSelectedRowKeys] = useState([]);
                const [batchImportVisible, setBatchImportVisible] = useState(false);
                const [importData, setImportData] = useState([]);
                const [form] = Form.useForm();

                // ç»Ÿè®¡æ•°æ®
                const statistics = useMemo(() => {
                    const total = data.length;
                    const inTransit = data.filter(item => item.status === 'in-transit').length;
                    const shelved = data.filter(item => item.status === 'shelved').length;
                    const cancelled = data.filter(item => item.status === 'cancelled').length;
                    const totalQuantity = data.reduce((sum, item) => sum + item.shipQuantity, 0);
                    const shelvedQuantity = data.filter(item => item.status === 'shelved')
                        .reduce((sum, item) => sum + (item.actualShelfQuantity || 0), 0);

                    return {
                        total,
                        inTransit,
                        shelved,
                        cancelled,
                        totalQuantity,
                        shelvedQuantity
                    };
                }, [data]);

                // è¡¨æ ¼åˆ—å®šä¹‰
                const columns = [
                    {
                        title: 'é‡‡è´­è®¢å•å·',
                        dataIndex: 'purchaseOrderNo',
                        key: 'purchaseOrderNo',
                        width: 140,
                        render: (text) => (
                            React.createElement(Button, { type: "link", size: "small", style: { padding: 0 } }, text)
                        )
                    },
                    {
                        title: 'å¤‡è´§å•å·',
                        dataIndex: 'stockOrderNo',
                        key: 'stockOrderNo',
                        width: 140
                    },
                    {
                        title: 'å‘è´§æ•°é‡',
                        dataIndex: 'shipQuantity',
                        key: 'shipQuantity',
                        width: 100,
                        align: 'right',
                        render: (text) => text?.toLocaleString()
                    },
                    {
                        title: 'å‘å¾€ä»“',
                        dataIndex: 'destinationWarehouse',
                        key: 'destinationWarehouse',
                        width: 140,
                        ellipsis: true
                    },
                    {
                        title: 'å‘è´§æ—¶é—´',
                        dataIndex: 'shipDate',
                        key: 'shipDate',
                        width: 120,
                        render: (text) => text || '-'
                    },
                    {
                        title: 'åˆ°æ¸¯æ—¶é—´',
                        dataIndex: 'arrivalPortDate',
                        key: 'arrivalPortDate',
                        width: 120,
                        render: (text) => text || '-'
                    },
                    {
                        title: 'åˆ°ä»“æ—¶é—´',
                        dataIndex: 'arrivalWarehouseDate',
                        key: 'arrivalWarehouseDate',
                        width: 120,
                        render: (text) => text || '-'
                    },
                    {
                        title: 'ä¸Šæ¶æ—¶é—´',
                        dataIndex: 'shelfDate',
                        key: 'shelfDate',
                        width: 120,
                        render: (text) => text || '-'
                    },
                    {
                        title: 'å®é™…ä¸Šæ¶æ•°é‡',
                        dataIndex: 'actualShelfQuantity',
                        key: 'actualShelfQuantity',
                        width: 120,
                        align: 'right',
                        render: (text) => text ? text.toLocaleString() : '-'
                    },
                    {
                        title: 'çŠ¶æ€',
                        dataIndex: 'status',
                        key: 'status',
                        width: 100,
                        render: (status) => {
                            const config = statusConfig[status];
                            return React.createElement(Tag, { color: config.color }, config.text);
                        }
                    },
                    {
                        title: 'æ“ä½œ',
                        key: 'action',
                        width: 120,
                        fixed: 'right',
                        render: (_, record) => (
                            React.createElement(Space, { size: "small" }, [
                                React.createElement(Button, { key: "edit", type: "link", size: "small" }, "ç¼–è¾‘"),
                                React.createElement(Popconfirm, {
                                    key: "delete",
                                    title: "ç¡®å®šè¦åˆ é™¤è¿™æ¡è®°å½•å—ï¼Ÿ",
                                    onConfirm: () => handleDelete(record.key),
                                    okText: "ç¡®å®š",
                                    cancelText: "å–æ¶ˆ"
                                }, React.createElement(Button, { type: "link", size: "small", danger: true }, "åˆ é™¤"))
                            ])
                        )
                    }
                ];

                // å¤„ç†ç­›é€‰
                const handleFilter = (values) => {
                    console.log('ç­›é€‰æ¡ä»¶:', values);
                    setLoading(true);
                    setTimeout(() => {
                        setLoading(false);
                        message.success('ç­›é€‰å®Œæˆ');
                    }, 1000);
                };

                // é‡ç½®ç­›é€‰
                const handleReset = () => {
                    form.resetFields();
                    setData(mockData);
                    message.success('å·²é‡ç½®ç­›é€‰æ¡ä»¶');
                };

                // åˆ é™¤è®°å½•
                const handleDelete = (key) => {
                    setData(data.filter(item => item.key !== key));
                    message.success('åˆ é™¤æˆåŠŸ');
                };

                // æ‰¹é‡å¯¼å…¥
                const handleBatchImport = () => {
                    setBatchImportVisible(true);
                };

                // å¯¼å‡ºæ•°æ®
                const handleExport = () => {
                    message.success('å¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­...');
                };

                // åˆ·æ–°æ•°æ®
                const handleRefresh = () => {
                    setLoading(true);
                    setTimeout(() => {
                        setLoading(false);
                        message.success('æ•°æ®å·²åˆ·æ–°');
                    }, 1000);
                };

                // è¡Œé€‰æ‹©é…ç½®
                const rowSelection = {
                    selectedRowKeys,
                    onChange: setSelectedRowKeys
                };

                return React.createElement('div', { className: "app-container" }, [
                    // é¡µé¢å¤´éƒ¨
                    React.createElement('div', { key: "header", className: "page-header" }, [
                        React.createElement('h1', { key: "title", className: "page-title" }, "DDPåœ¨é€”åº“å­˜ç›‘æ§"),
                        React.createElement('p', { key: "desc", className: "page-description" }, 
                            "ç®¡ç†å’Œç›‘æ§DDPæ¨¡å¼ä¸‹çš„åœ¨é€”åº“å­˜ï¼Œè·Ÿè¸ªä»é‡‡è´­ä¸‹å•åˆ°æµ·å¤–ä»“ä¸Šæ¶çš„å…¨æµç¨‹çŠ¶æ€")
                    ]),

                    // ç»Ÿè®¡å¡ç‰‡
                    React.createElement(Row, { key: "stats", gutter: 16, style: { marginBottom: 24 } }, [
                        React.createElement(Col, { key: "total", span: 6 }, 
                            React.createElement(Card, null, 
                                React.createElement(Statistic, {
                                    title: "æ€»è®¢å•æ•°",
                                    value: statistics.total,
                                    suffix: "å•"
                                })
                            )
                        ),
                        React.createElement(Col, { key: "transit", span: 6 }, 
                            React.createElement(Card, null, 
                                React.createElement(Statistic, {
                                    title: "åœ¨é€”è®¢å•",
                                    value: statistics.inTransit,
                                    suffix: "å•",
                                    valueStyle: { color: '#1890ff' }
                                })
                            )
                        ),
                        React.createElement(Col, { key: "shelved", span: 6 }, 
                            React.createElement(Card, null, 
                                React.createElement(Statistic, {
                                    title: "å·²ä¸Šæ¶è®¢å•",
                                    value: statistics.shelved,
                                    suffix: "å•",
                                    valueStyle: { color: '#52c41a' }
                                })
                            )
                        ),
                        React.createElement(Col, { key: "rate", span: 6 }, 
                            React.createElement(Card, null, 
                                React.createElement(Statistic, {
                                    title: "ä¸Šæ¶å®Œæˆç‡",
                                    value: statistics.total > 0 ? ((statistics.shelvedQuantity / statistics.totalQuantity) * 100).toFixed(1) : 0,
                                    suffix: "%",
                                    valueStyle: { color: '#722ed1' }
                                })
                            )
                        )
                    ]),

                    // ç­›é€‰åŒºåŸŸ
                    React.createElement('div', { key: "filters", className: "filter-section" }, 
                        React.createElement(Form, {
                            form: form,
                            layout: "inline",
                            onFinish: handleFilter,
                            style: { marginBottom: 16 }
                        }, [
                            React.createElement(Form.Item, { key: "po", name: "purchaseOrderNo", label: "é‡‡è´­è®¢å•å·" },
                                React.createElement(Input, { placeholder: "è¯·è¾“å…¥é‡‡è´­è®¢å•å·", style: { width: 180 } })
                            ),
                            React.createElement(Form.Item, { key: "so", name: "stockOrderNo", label: "å¤‡è´§å•å·" },
                                React.createElement(Input, { placeholder: "è¯·è¾“å…¥å¤‡è´§å•å·", style: { width: 180 } })
                            ),
                            React.createElement(Form.Item, { key: "warehouse", name: "destinationWarehouse", label: "å‘å¾€ä»“" },
                                React.createElement(Select, { placeholder: "è¯·é€‰æ‹©ä»“åº“", style: { width: 160 }, allowClear: true },
                                    warehouseOptions.map(warehouse => 
                                        React.createElement(Option, { key: warehouse, value: warehouse }, warehouse)
                                    )
                                )
                            ),
                            React.createElement(Form.Item, { key: "status", name: "status", label: "çŠ¶æ€" },
                                React.createElement(Select, { placeholder: "è¯·é€‰æ‹©çŠ¶æ€", style: { width: 120 }, allowClear: true }, [
                                    React.createElement(Option, { key: "in-transit", value: "in-transit" }, "åœ¨é€”ä¸­"),
                                    React.createElement(Option, { key: "shelved", value: "shelved" }, "å·²ä¸Šæ¶"),
                                    React.createElement(Option, { key: "cancelled", value: "cancelled" }, "å·²å–æ¶ˆ")
                                ])
                            ),
                            React.createElement(Form.Item, { key: "buttons" },
                                React.createElement(Space, null, [
                                    React.createElement(Button, { key: "search", type: "primary", htmlType: "submit", loading: loading }, "æŸ¥è¯¢"),
                                    React.createElement(Button, { key: "reset", onClick: handleReset }, "é‡ç½®")
                                ])
                            )
                        ])
                    ),

                    // è¡¨æ ¼åŒºåŸŸ
                    React.createElement('div', { key: "table", className: "table-section" }, [
                        React.createElement('div', { key: "toolbar", className: "table-toolbar" }, [
                            React.createElement('div', { key: "left", className: "toolbar-left" }, [
                                React.createElement(Button, { key: "import", type: "primary", onClick: handleBatchImport }, "æ‰¹é‡å¯¼å…¥æ—¥æœŸ"),
                                React.createElement(Button, { key: "export", onClick: handleExport }, "å¯¼å‡ºæ•°æ®"),
                                selectedRowKeys.length > 0 && React.createElement(Popconfirm, {
                                    key: "batch-delete",
                                    title: `ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„ ${selectedRowKeys.length} æ¡è®°å½•å—ï¼Ÿ`,
                                    onConfirm: () => {
                                        setData(data.filter(item => !selectedRowKeys.includes(item.key)));
                                        setSelectedRowKeys([]);
                                        message.success('æ‰¹é‡åˆ é™¤æˆåŠŸ');
                                    },
                                    okText: "ç¡®å®š",
                                    cancelText: "å–æ¶ˆ"
                                }, React.createElement(Button, { danger: true }, "æ‰¹é‡åˆ é™¤"))
                            ]),
                            React.createElement('div', { key: "right", className: "toolbar-right" }, 
                                React.createElement(Tooltip, { title: "åˆ·æ–°æ•°æ®" },
                                    React.createElement(Button, { icon: "ğŸ”„", onClick: handleRefresh, loading: loading })
                                )
                            )
                        ]),

                        React.createElement(Table, {
                            key: "data-table",
                            columns: columns,
                            dataSource: data,
                            rowSelection: rowSelection,
                            loading: loading,
                            scroll: { x: 1400 },
                            pagination: {
                                total: data.length,
                                pageSize: 10,
                                showSizeChanger: true,
                                showQuickJumper: true,
                                showTotal: (total, range) => `ç¬¬ ${range[0]}-${range[1]} æ¡/å…± ${total} æ¡è®°å½•`
                            },
                            size: "middle"
                        })
                    ]),

                    // æ‰¹é‡å¯¼å…¥å¼¹çª—
                    React.createElement(Modal, {
                        key: "import-modal",
                        title: "æ‰¹é‡å¯¼å…¥æ—¥æœŸ",
                        visible: batchImportVisible,
                        onCancel: () => {
                            setBatchImportVisible(false);
                            setImportData([]);
                        },
                        footer: [
                            React.createElement(Button, { 
                                key: "cancel", 
                                onClick: () => {
                                    setBatchImportVisible(false);
                                    setImportData([]);
                                }
                            }, "å–æ¶ˆ"),
                            React.createElement(Button, {
                                key: "confirm",
                                type: "primary",
                                loading: loading,
                                disabled: importData.length === 0,
                                onClick: () => {
                                    message.success('å¯¼å…¥åŠŸèƒ½æ¼”ç¤ºï¼šå·²æ¨¡æ‹Ÿå¯¼å…¥æˆåŠŸ');
                                    setBatchImportVisible(false);
                                    setImportData([]);
                                }
                            }, `ç¡®è®¤å¯¼å…¥ (${importData.length})`)
                        ],
                        width: 800
                    }, [
                        React.createElement('div', { key: "upload-area", style: {
                            border: '2px dashed #d9d9d9',
                            borderRadius: '6px',
                            background: '#fafafa',
                            textAlign: 'center',
                            padding: '40px 20px',
                            cursor: 'pointer'
                        }, onClick: () => {
                            const mockImportData = [
                                { key: 'import1', purchaseOrderNo: 'PO202412006', arrivalPortDate: '2024-12-25' },
                                { key: 'import2', purchaseOrderNo: 'PO202412007', arrivalPortDate: '2024-12-26' }
                            ];
                            setImportData(mockImportData);
                            message.success('æ¨¡æ‹Ÿæ–‡ä»¶è§£ææˆåŠŸï¼Œè¯·ç¡®è®¤å¯¼å…¥æ•°æ®');
                        }}, [
                            React.createElement('p', { key: "icon", style: { fontSize: 48, margin: '16px 0' } }, "ğŸ“"),
                            React.createElement('p', { key: "text", style: { fontSize: 16, margin: '0 0 8px 0' } }, "ç‚¹å‡»æ­¤åŒºåŸŸæ¨¡æ‹Ÿæ–‡ä»¶ä¸Šä¼ "),
                            React.createElement('p', { key: "hint", style: { color: '#8c8c8c', margin: 0 } }, "æ”¯æŒ Excel (.xlsx, .xls) å’Œ CSV æ ¼å¼æ–‡ä»¶")
                        ]),
                        
                        importData.length > 0 && React.createElement('div', { key: "preview", style: { marginTop: 24 } }, [
                            React.createElement(Title, { key: "preview-title", level: 5 }, "é¢„è§ˆå¯¼å…¥æ•°æ®"),
                            React.createElement(Table, {
                                key: "preview-table",
                                columns: [
                                    { title: 'é‡‡è´­è®¢å•å·', dataIndex: 'purchaseOrderNo', key: 'purchaseOrderNo' },
                                    { title: 'åˆ°æ¸¯æ—¶é—´', dataIndex: 'arrivalPortDate', key: 'arrivalPortDate' }
                                ],
                                dataSource: importData,
                                pagination: false,
                                size: "small"
                            })
                        ])
                    ])
                ]);
            };

            // æ¸²æŸ“åº”ç”¨
            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(React.createElement(DDPInventoryMonitor));
        }
    </script>
</body>
</html>
